rootProject.name = 'repositories'

// Adjust this if the workspace directory is located elsewhere.
def workspaceDir = file('/workspace/repositories')

// Safety check: ensure the directory exists
if (!workspaceDir.exists() || !workspaceDir.isDirectory()) {
  throw new GradleException("The workspace directory at $workspaceDir is missing or not a directory.")
}

// The directory where this settings file resides
def aggregatorDir = settingsDir

workspaceDir.eachDir { projectDir ->
  // Check if this directory is a Gradle project by looking for a build script
  boolean hasGradleScript = new File(projectDir, 'build.gradle').exists() ||
    new File(projectDir, 'build.gradle.kts').exists()

  // Ensure we don't include the aggregator's own directory again
  // Compare canonical paths to ensure reliability
  def projectDirCanonical = projectDir.canonicalFile
  def aggregatorDirCanonical = aggregatorDir.canonicalFile

  if (hasGradleScript && projectDirCanonical != aggregatorDirCanonical) {
    //include(projectDir.name)
    //project(":${projectDir.name}").projectDir = projectDir
    includeBuild(projectDir)
  }
}
